<style lang="less">
  @primary-color: #ff2a48;
  .agent {
    background-color: #f5f5f5;
    height: 100%;
    .title{
      font-size: 28rpx;
      color: #888;
      margin: 20rpx 0;
    }
    .agent-tab {
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 30rpx;
      background-color: #fff;
      border-bottom: 1px solid #eee;
      .tab {
        margin: 0 6rpx;
        padding: 20rpx 10rpx;
        &.active {
          color: @primary-color;
          border-bottom: 4rpx solid @primary-color;
        }
      }
    }

    .statistical{
      .could-withdraw{
        background-color: #f83654;
        padding: 25rpx 50rpx 60rpx;
        .title{
          color: #fff;
        }
        .price{
          font-size: 60rpx;
          color: #fff;
        }
      }
      .no-withdraw{
        display: flex;
        background-color: #fff;
        .price{
          color: #000;
          font-size: 44rpx;
        }
        .title{
          color: #bbb;
        }
        .forecast-withdraw{
          flex: 1;
          padding: 10rpx 50rpx 30rpx;
          border-right: 1rpx solid #f4f4f4;
        }
        .already-withdraw{
          flex: 1;
          padding: 10rpx 50rpx 30rpx;
        }
      }

      .day {
        margin-top: 20rpx;
        background-color: #fff;
        padding: 0 30rpx;
        .day-title {
          padding: 20rpx 0;
          border-bottom: 1rpx solid #f4f4f4;
          font-size: 32rpx;
          .day-note {
            padding-left: 20rpx;
          }
        }
        .data {
          display: flex;
          padding: 30rpx 0 20rpx;
          .withdraw, .order-amount{
            flex: 1;
            text-align: center;
            padding-top: 10rpx;
          }
          .withdraw {
            border-right: 1px solid #f5f5f5;
          }
        }
      }

      .today{
        .day-note{
          border-left: 6rpx solid #f83654;
        }
        .withdraw{
          .price{
            color: #f96547;
          }
        }
        .order-amount{
          .price{
            color: #f96547;
          }
        }
      }

      .yesterday{
        .day-note{
          border-left: 6rpx solid #f89342;
        }
      }
    }

    .orders {
      .filter{
        padding: 20rpx;
        display: flex;
        justify-content: space-between;
      }
      .all-order {
        font-size: 26rpx;
        color: #444;
      }
      .picker{
        display: inline-block;
        .date {
          font-size: 26rpx;
          color: #999;
          .image{
            width: 26rpx;
            height: 26rpx;
            margin-right: 20rpx;
          }
        }
      }
    }
  }
</style>
<template>
  <view class="agent">
    <view class="agent-tab">
      <text class="tab {{tabShow=='statistical'?'active':''}}"
            @tap="toggleTabShow('statistical')">收益统计
      </text>
      <text class="tab {{tabShow=='orders'?'active':''}}"
            @tap="toggleTabShow('orders')">订单明细
      </text>
    </view>

    <view class="statistical" wx:if="{{tabShow === 'statistical'}}">
      <view class="could-withdraw">
        <view class="title">可提现收益</view>
        <view class="price">¥{{agent.canWithDraw}}</view>
      </view>

      <view class="no-withdraw">
        <view class="forecast-withdraw">
          <view class="title">预估收益</view>
          <view class="price">¥{{agent.estimate}}</view>
        </view>

        <view class="already-withdraw">
          <view class="title">已提现收益</view>
          <view class="price">¥{{agent.withDrawed}}</view>
        </view>
      </view>

      <view class="today day">
        <view class="day-title">
          <view class="day-note">今日</view>
        </view>
        <view class="data">
          <view class="withdraw">
            <view class="price">{{agent.estimateToday}}</view>
            <view class="title">预估收益</view>
          </view>
          <view class="order-amount">
            <view class="price">{{agent.orderNumToday}}</view>
            <view class="title">成交笔数</view>
          </view>
        </view>
      </view>

      <view class="yesterday day">
        <view class="day-title">
          <view class="day-note">昨日</view>
        </view>
        <view class="data">
          <view class="withdraw">
            <view class="price">{{agent.estimateYesterday}}</view>
            <view class="title">预估收益</view>
          </view>
          <view class="order-amount">
            <view class="price">{{agent.orderNumYesterday}}</view>
            <view class="title">成交笔数</view>
          </view>
        </view>
      </view>
    </view>


    <view class="orders" wx:if="{{tabShow === 'orders'}}">
      <view class="filter">
        <text class="all-order">{{date}}</text>
        <picker class="picker" bindchange="bindDateChange" mode="date" value="{{date}}">
          <view class="date">
            <image class="image" src="../images/calender.png"></image>
            <text>筛选</text>
          </view>
        </picker>
      </view>
      <view class="order-list">
        <repeat for="{{orders}}" key="index" index="index" item="item">
          <Order :order.sync="item"></Order>
        </repeat>
      </view>
    </view>
  </view>
</template>

<script>
  import wepy from 'wepy'

  import Order from '../components/agent/Order'
  import api from '../mixins/api'
  import Store from '../mixins/store'

  export default class DetailPage extends wepy.page {
    config = {}

    components = {
      Order: Order
    }

    data = {
      tabShow: 'orders',
      date: '全部订单',
      agent: {},
      orders: []
    }

    computed = {}

    methods = {
      toggleTabShow(tab) {
        this.tabShow = tab
      },
      bindDateChange(e) {
        console.log(e.detail)
        this.date = e.detail.value
      }
    }

    events = {}

    onLoad () {
      console.log(this.$wxapp)
    }

    fetchWithdraw() {

    }

    formatDate(date,fmt) {
      var o = {
        "M+": date.getMonth() + 1, //月份
        "d+": date.getDate(), //日
        "h+": date.getHours(), //小时
        "m+": date.getMinutes(), //分
        "s+": date.getSeconds(), //秒
        "q+": Math.floor((date.getMonth() + 3) / 3), //季度
        "S": date.getMilliseconds() //毫秒
      };
      if (/(y+)/.test(fmt)) fmt = fmt.replace(RegExp.$1, (date.getFullYear() + "").substr(4 - RegExp.$1.length));
      for (var k in o)
        if (new RegExp("(" + k + ")").test(fmt)) fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (o[k]) : (("00" + o[k]).substr(("" + o[k]).length)));
      return fmt;
    }
  }
</script>
